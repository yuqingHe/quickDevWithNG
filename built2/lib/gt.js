(function(window,document){if(window.initGeetest)return;var head=document.getElementsByTagName("head")[0],protocol=location.protocol+"//",callbacks=[],status="init",random=function(){return parseInt(Math.random()*1e4)+(new Date).valueOf()},run=function(){for(var i=0,len=callbacks.length;i<len;i+=1)callbacks[i]();callbacks=[]},detect=function(){return window.Geetest||document.getElementById("gt_lib")},down=function(config){var s=document.createElement("script");s.charset="UTF-8",s.type="text/javascript",s.onload=s.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){if(detect())status="loaded",run();else{status="fail";if(typeof config.onError!="function")throw new Error("网络错误");config.onError()}s.onload=s.onreadystatechange=null}},s.onerror=function(){status="fail",s.onerror=null;if(typeof config.onError!="function")throw new Error("网络错误");config.onError()};var staticServer=config.staticservers&&config.staticservers[0]||"static.geetest.com/";s.src=protocol+staticServer+"static/js/geetest.0.0.0.js",head.appendChild(s)},getLib=function(config){status="loading";var cb="geetest_"+random();window[cb]=function(){status="loaded",run(),window[cb]=undefined;try{delete window[cb]}catch(e){}};var s=document.createElement("script");s.charset="UTF-8",s.type="text/javascript",s.onload=s.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")detect()||down(config)},s.onerror=function(){down(config)};var apiServer=config.apiserver||"api.geetest.com/";s.src=protocol+apiServer+"getfrontlib.php?gt="+config.gt+"&callback="+cb,head.appendChild(s)};detect()&&(status="loaded"),window.initGeetest=function(config,callback){if(typeof config.gt!="string")throw new Error("");var init=function(){callback(new window.Geetest(config))};if(status==="loaded")init();else if(status==="fail"){if(typeof config.onError!="function")throw new Error("网络错误");config.onError()}else status==="loading"?callbacks.push(function(){init()}):status==="init"&&(callbacks.push(function(){init()}),getLib(config))}})(window,document);